---
title: 索引优化（2）
date: 2020-06-27 16:43:54
tags: [MySQL , 读书笔记 , 高性能MySQL第3版]
declare: true
---
### 独立的列
即索引不能是表达式的一部分
```
错误的例子
select age from emp where age + 1 = 40
```

### 前缀索引和索引选择性
+ 前缀索引
前缀索引是一种能使索引更小，更快的方式，即只索引开始的部分字符，这样可以节约索引空间，提高索引效率。
对于BLOB，TEXT，很长的VARCHAR列，必须使用前缀索引，应为MySQL不允许索引这些列的完整长度。
```
ALTER TABLE dept add key(name(5))
```
但是这也会降低索引选择性。

+ 索引选择性
**不重复的索引值和数据表的记录总数的比值，索引选择性越高则查询效率越高**，因为选择性高的索引能让MySQL在查找时过滤更多的行。

+ 计算索引选择性
```
SELECT
    count( DISTINCT LEFT ( NAME, 3 ) ) / count( 1 ) sel3,
    count( DISTINCT LEFT ( NAME, 4 ) ) / count( 1 ) sel4,
    count( DISTINCT LEFT ( NAME, 5 ) ) / count( 1 ) sel5
FROM
    dept
```
一般来说能够接近0.031，基本就可用。

### 多列索引及索引列的顺序
+ 多列索引
// todo